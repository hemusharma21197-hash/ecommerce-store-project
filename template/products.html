{% extends "base.html" %}

{% block title %}All Products – ShopEasy{% endblock %}

{% block content %}

<!-- ================= AMAZON-STYLE PAGE HEADER ================= -->
<div class="products-header">
    <h1>Shop Products</h1>

    <form method="GET" action="{{ url_for('products') }}" class="search-bar">
        <input type="text" name="search" placeholder="Search for products..."
               value="{{ request.args.get('search', '') }}">
        <button><i class="fas fa-search"></i></button>
    </form>
</div>

<!-- ================= CATEGORY FILTER BAR ================= -->
<div class="category-bar">
    <a href="{{ url_for('products') }}">All</a>
    <a href="{{ url_for('products') }}?category=Electronics">Electronics</a>
    <a href="{{ url_for('products') }}?category=Clothing">Clothing</a>
    <a href="{{ url_for('products') }}?category=Books">Books</a>
    <a href="{{ url_for('products') }}?category=Home">Home</a>
</div>

<div class="layout">

    <!-- ================= LEFT SIDEBAR FILTERS ================= -->
    <aside class="sidebar">
        <h3>Filter By</h3>

        <div class="filter-box">
            <h4>Category</h4>
            <ul>
                <li><a href="{{ url_for('products') }}">All</a></li>
                <li><a href="{{ url_for('products') }}?category=Electronics">Electronics</a></li>
                <li><a href="{{ url_for('products') }}?category=Clothing">Clothing</a></li>
                <li><a href="{{ url_for('products') }}?category=Books">Books</a></li>
                <li><a href="{{ url_for('products') }}?category=Home">Home</a></li>
            </ul>
        </div>

        <div class="filter-box">
            <h4>Price</h4>
            <ul>
                <li><a href="#">Under $25</a></li>
                <li><a href="#">$25 – $50</a></li>
                <li><a href="#">$50 – $100</a></li>
                <li><a href="#">Over $100</a></li>
            </ul>
        </div>
    </aside>

    <!-- ================= PRODUCT GRID ================= -->
    <main class="product-grid">

        {% if products %}
            {% for product in products %}
            <div class="product-card">

                <div class="img-container">
                    <img src="{{ product.image }}"
                         alt="{{ product.name }}"
                         onerror="this.src='https://via.placeholder.com/300x200?text=Image'">
                </div>

                <h3>{{ product.name }}</h3>

                <p class="desc">{{ product.description[:80] }}...</p>

                <div class="price">
                    ${{ "%.2f"|format(product.price) }}
                </div>

                <div class="actions">
                    <a href="{{ url_for('add_to_cart', product_id=product.id) }}" class="add-btn">
                        <i class="fas fa-cart-plus"></i> Add to Cart
                    </a>

                    <a href="{{ url_for('edit_product', product_id=product.id) }}" class="edit-btn">
                        <i class="fas fa-edit"></i>
                    </a>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <p>No products found.</p>
        {% endif %}

    </main>
</div>

<!-- ================= STYLES ================= -->
<style>

.products-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}
.products-header h1 { font-size: 1.8rem; }

/* Search Bar */
.search-bar {
    display: flex;
    width: 350px;
}
.search-bar input {
    flex: 1;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 6px 0 0 6px;
    outline: none;
}
.search-bar button {
    background: #febd69;
    border: none;
    padding: 10px 16px;
    border-radius: 0 6px 6px 0;
    cursor: pointer;
}
.search-bar button i { color: #111; }

/* Category Bar */
.category-bar {
    background: #232f3e;
    padding: 12px;
    display: flex;
    gap: 20px;
    margin-bottom: 20px;
}
.category-bar a {
    color: white;
    font-size: 0.9rem;
    text-decoration: none;
}
.category-bar a:hover { color: #febd69; }

/* Page Layout */
.layout {
    display: grid;
    grid-template-columns: 220px 1fr;
    gap: 20px;
}

/* Sidebar */
.sidebar {
    background: white;
    padding: 15px;
    border-radius: 8px;
    height: fit-content;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}
.sidebar h3 { margin-bottom: 10px; }
.sidebar .filter-box { margin-bottom: 20px; }
.sidebar ul { list-style: none; padding-left: 0; }
.sidebar li { margin: 6px 0; }
.sidebar a {
    text-decoration: none;
    font-size: 0.95rem;
    color: #232f3e;
}
.sidebar a:hover {
    color: #febd69;
}

/* Product Grid */
.product-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    gap: 20px;
}

/* Product Card */
.product-card {
    background: white;
    padding: 12px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    transition: transform .2s;
}
.product-card:hover {
    transform: translateY(-5px);
}

/* Image */
.img-container {
    height: 180px;
    overflow: hidden;
    margin-bottom: 10px;
    border-radius: 8px;
}
.img-container img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* Text */
.product-card h3 {
    font-size: 1.1rem;
    min-height: 45px;
}
.desc {
    font-size: 0.85rem;
    color: #555;
    height: 40px;
    margin-bottom: 10px;
}

.price {
    font-size: 1.2rem;
    font-weight: bold;
    color: #b12704;
}

/* Buttons */
.actions {
    margin-top: 10px;
    display: flex;
    justify-content: space-between;
}
.add-btn {
    background: #ffa41c;
    color: #111;
    padding: 7px 12px;
    border-radius: 4px;
    font-size: 0.9rem;
    text-decoration: none;
    font-weight: bold;
}
.add-btn:hover { background: #f08804; }

.edit-btn {
    background: #ddd;
    padding: 6px 10px;
    border-radius: 4px;
    color: #333;
}
.edit-btn:hover { background: #ccc; }

/* Responsive */
@media(max-width: 768px) {
    .layout { grid-template-columns: 1fr; }
    .sidebar { order: 2; }
}
</style>

{% endblock %}
